<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
    http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<changeSet id="charivari-perm-1.0-01.1-createInitialTable" author="juliejohn">
		<createTable tableName="PERMANENCE">
			<column type="integer" name="PERMANENCE_ID" autoIncrement="true"></column>
			<column type="date" name="START_DATE"></column>
			<column type="date" name="END_DATE"></column>
			<column type="integer" name="STATUS"></column>
			<column type="integer" name="FAMILY_ID"></column>
		</createTable>

		<createTable tableName="FAMILY">
			<column type="integer" name="FAMILY_ID" autoIncrement="true"></column>
			<column type="varchar(255)" name="LABEL"></column>
		</createTable>
		
		<createTable tableName="SCHEDULING">
			<column type="integer" name="SCHEDULING_ID" autoIncrement="true"></column>
			<column type="integer" name="FAMILY_ID"></column>
			<column type="integer" name="DURATION"></column>
			<column type="integer" name="FREQUENCY"></column>
			<column type="date" name="START_DAY"></column>
		</createTable>

		<createTable tableName="PERSON">
			<column type="integer" name="PERSON_ID" autoIncrement="true"></column>
			<column type="integer" name="FAMILY_ID"></column>
			<column type="varchar(255)" name="LAST_NAME"></column>
			<column type="varchar(255)" name="FIRST_NAME"></column>
			<column type="date" name="BIRTH_DATE" />
			<column type="varchar(255)" name="PHONE_NUMBER" />
			<column type="varchar(255)" name="EMAIL" />
			<column type="text" name="IMAGE_URL" />
			<column type="integer" name="PERSON_TYPE" />
		</createTable>
	</changeSet>

	<changeSet id="charivari-perm-1.0-01.2-primaryKey-constraints" author="juliejohn">
		<addPrimaryKey columnNames="PERMANENCE_ID" constraintName="PK_PERMANENCE_ID" tableName="PERMANENCE" />
		<addPrimaryKey columnNames="FAMILY_ID" constraintName="PK_FAMILY_ID" tableName="FAMILY" />
		<addPrimaryKey columnNames="SCHEDULING_ID" constraintName="PK_SCHEDULING_ID" tableName="SCHEDULING" />
		<addPrimaryKey columnNames="PERSON_ID" constraintName="PK_PERSON_ID" tableName="PERSON" />
	</changeSet>

	<changeSet id="charivari-perm-1.0-01.3-foreignKey-constraints" author="juliejohn">
		<addForeignKeyConstraint baseColumnNames="FAMILY_ID"
			baseTableName="PERMANENCE" constraintName="FK_PERMANENCE_FAMILY"
			referencedColumnNames="FAMILY_ID" referencedTableName="FAMILY" />
		<addForeignKeyConstraint baseColumnNames="FAMILY_ID"
			baseTableName="SCHEDULING" constraintName="FK_SCHEDULING_FAMILY"
			referencedColumnNames="FAMILY_ID" referencedTableName="FAMILY" />
		<addForeignKeyConstraint baseColumnNames="FAMILY_ID"
			baseTableName="PERSON" constraintName="FK_PERSON_FAMILY"
			referencedColumnNames="FAMILY_ID" referencedTableName="FAMILY" />
	</changeSet>
	<changeSet id="charivari-perm-1.0-01.3-add-image-table" author="juliejohn">
		<createTable tableName="IMAGE">
			<column type="integer" name="IMAGE_ID" autoIncrement="true"></column>
			<column type="varchar(255)" name="URL"></column>
		</createTable>
		<dropColumn tableName="PERSON" columnName="IMAGE_URL"/>
		<addColumn tableName="PERSON">
			<column type="integer" name="IMAGE_ID"></column>
		</addColumn>
		<addPrimaryKey columnNames="IMAGE_ID" constraintName="PK_IMAGE_ID" tableName="IMAGE" />
		<addForeignKeyConstraint baseColumnNames="IMAGE_ID"
			baseTableName="PERSON" constraintName="FK_PERSON_IMAGE"
			referencedColumnNames="IMAGE_ID" referencedTableName="IMAGE" />
	</changeSet>
	<changeSet id="charivari-perm-1.0-02.01-change-to-datetime" author="adi3000">
		<dropColumn tableName="PERMANENCE" columnName="START_DATE"/>
		<dropColumn tableName="PERMANENCE" columnName="END_DATE"/>
		<dropColumn tableName="SCHEDULING" columnName="START_DAY"/>
	</changeSet>
	<changeSet id="charivari-perm-1.0-02.02-change-to-datetime" author="adi3000">
		<addColumn tableName="PERMANENCE">
			<column name="START_DATE" type="datetime"></column>
		</addColumn> 
		<addColumn tableName="PERMANENCE">
			<column name="END_DATE" type="datetime"></column>
		</addColumn> 
		<addColumn tableName="SCHEDULING">
			<column name="START_DAY" type="datetime"></column>
		</addColumn> 
	</changeSet>
	<changeSet id="charivari-perm-1.0-02.3-add-image-column" author="juliejohn">
		<addColumn tableName="FAMILY">
			<column type="integer" name="IMAGE_ID"></column>
		</addColumn>
		<addForeignKeyConstraint baseColumnNames="IMAGE_ID"
			baseTableName="FAMILY" constraintName="FK_FAMILY_IMAGE"
			referencedColumnNames="IMAGE_ID" referencedTableName="IMAGE" />
	</changeSet>
	<changeSet id="charivari-perm-1.0-02.4-add-original-family-column" author="juliejohn">
		<addColumn tableName="PERMANENCE">
			<column type="integer" name="ORIGINAL_FAMILY_ID"></column>
		</addColumn>
	</changeSet>
	<changeSet id="charivari-perm-1.0-02.5-add-is-open-column" author="juliejohn">
		<addColumn tableName="PERMANENCE">
			<column type="boolean" name="IS_OPEN"></column>
		</addColumn>
		<addDefaultValue
            tableName="PERMANENCE"
            columnDataType="boolean"
            columnName="IS_OPEN"
            defaultValueBoolean="true"/>
	</changeSet>
	<changeSet id="charivari-perm-1.0-02.6-add-holidays-table" author="juliejohn">
		<createTable tableName="HOLIDAYS">
			<column type="integer" name="HOLIDAYS_ID" autoIncrement="true"></column>
			<column type="date" name="START_DATE"></column>
			<column type="date" name="END_DATE"></column>
		</createTable>
		<addPrimaryKey columnNames="HOLIDAYS_ID" constraintName="PK_HOLIDAYS_ID" tableName="HOLIDAYS" />
		<addColumn tableName="FAMILY">
			<column type="date" name="START_DATE_CONTRACT"></column>
		</addColumn>
		<addColumn tableName="FAMILY">
			<column type="date" name="END_DATE_CONTRACT"></column>
		</addColumn>
	</changeSet>
	<changeSet id="charivari-perm-1.0-02.7-add-account-table" author="juliejohn">
		<createTable tableName="ACCOUNT">
			<column type="integer" name="ACCOUNT_ID" autoIncrement="true"></column>
			<column type="varchar(255)" name="LOGIN"></column>
			<column type="varchar(255)" name="MAIL"></column>
			<column type="varchar(255)" name="PASSWORD"></column>
			<column type="integer" name="TYPE"></column>
		</createTable>
		<addPrimaryKey columnNames="ACCOUNT_ID" constraintName="PK_ACCOUNT_ID" tableName="ACCOUNT" />
	</changeSet>
</databaseChangeLog>